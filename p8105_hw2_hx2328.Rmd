---
title: "p8105_hw2_hx2328"
author: "Hao Xu"
date: "10/8/2021"
output: github_document
---

```{r setup}
library(tidyverse)
library(readxl)
```

# Problem 1

Read and clean the Mr. Trash Wheel data

```{r}
trash_wheel_clean = read_excel("Trash-Wheel-Collection-Totals-8-6-19.xlsx", range = "A2:N408") %>% 
  janitor::clean_names() %>% 
  drop_na(dumpster) %>% 
  mutate(sports_balls = round(sports_balls))
```

Read and clean 2018 and 2019 precipitation data.

```{r}
precip_2018 = read_excel("Trash-Wheel-Collection-Totals-8-6-19.xlsx", sheet = 5, range = "A2:B14") %>% 
  janitor::clean_names() %>% 
  mutate(year = 2018)

precip_2019 = read_excel("Trash-Wheel-Collection-Totals-8-6-19.xlsx", sheet = 4, range = "A2:B14") %>% 
  janitor::clean_names() %>% 
  drop_na(total) %>% 
  mutate(year = 2019)
```

Combine precipitation dataset and convert month to a character variable

```{r}
precip_data = bind_rows(precip_2018, precip_2019) %>% 
  mutate(month = month.name[month])
```

The key variables in the Mr. Trash Wheel are the weight_towns, and the month and year. We could find the relationship between the weight of trash and precipitation amount.

If we calculate the total precipitation in 2018 and median number of sports balls in 2019:

```{r}
total_2018 = filter(precip_data, year == 2018)
sports_balls_2019 = filter(trash_wheel_clean, year == 2019)
```

The total precipitation in 2018 would be `r sum(total_2018$total)`.

The median number of sports balls in 2019 would be `r median(sports_balls_2019$sports_balls)`


# Problem 2

Read and clean pols-month.csv data.

```{r}
pols_month = read_csv("fivethirtyeight_datasets/pols-month.csv") %>% 
  janitor::clean_names() %>% 
  separate(mon, into = c("year", "month", "day"), sep = "-") %>% 
  mutate(month = month.name[as.numeric(month)]) %>% 
  mutate(president = prez_dem,
         president = recode(president, `1` = "dem", `0` = "gop"),
         president = factor(president),
         year = as.numeric(year)) %>% 
  select(-day, -prez_gop, -prez_dem)
```

Read and clean snp.csv data.

```{r}
snp = read_csv("fivethirtyeight_datasets/snp.csv") %>% 
  separate(date, into = c("month", "day", "year"), sep = "/") %>% 
  mutate(month = month.name[as.numeric(month)],
         year = as.numeric(year))

#There is something wrong with the date format when I read the csv file. The year variable is 2 digit instead of 4, so did some modifications.
for (i in 1:787){
  if (snp$year[i] <= 15){
    snp$year[i] = snp$year[i] + 2000
  }
  else{
    snp$year[i] = snp$year[i] + 1900
  }
}

snp = select(snp, -day) %>% 
  arrange(year, month) %>% 
  relocate(year, month)

  
```




